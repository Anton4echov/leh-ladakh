<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ò–≥—Ä–∞ "Ladakh Rider" - –ö—Ç–æ –≤ –õ–µ—Ö, –∫—Ç–æ –ø–æ –¥—Ä–æ–≤–∞?</title>
  <link rel="icon" href="IMG_20231118_212542_728.ico" type="image/x-icon">
  <meta name="description" content="–ò–≥—Ä–∞ –æ—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã—Ö –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤ –≤ –ì–∏–º–∞–ª–∞—è—Ö, –¢–∏–±–µ—Ç–µ –∏ –õ–∞–¥–∞–∫–µ." />
  <meta property="og:image" content="https://cdn.glitch.global/bea12857-f511-461d-adbc-da5b46687f87/IMG_20231118_212542_728.jpg?v=1750048499482">
  <link rel="icon" href="IMG_20231118_212542_728.ico" type="image/x-icon">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      height: 100%;
      touch-action: manipulation;
    }
    
    body {
      font-family: 'Lora', serif;
      color: #fff;
      background: url('https://cdn.glitch.global/bea12857-f511-461d-adbc-da5b46687f87/IMG_20231118_212542_728.jpg?v=1750048499482') no-repeat center center fixed;
      background-size: cover;
      line-height: 1.6;
      position: relative;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    
    header {
      background: rgba(0, 0, 0, 0.6);
      padding: 20px;
      text-align: center;
    }
    
    h1 {
      margin: 0;
      font-size: 1.2rem;
    }
    
    h2, p {
      text-align: center;
    }
    
    main {
      background: rgba(0, 0, 0, 0.5);
      max-width: 900px;
      margin: 30px auto;
      padding: 20px;
      border-radius: 8px;
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .game-container {
      position: relative;
      width: 100%;
      height: 50vh;
      margin: 20px auto;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-touch-callout: none;
      -webkit-tap-highlight-color: transparent;
    }
    
    #canvas1 {
      display: block; 
      background: black; 
      width: 100%;
      height: 100%;
      background: rgb(122, 122, 177);
      touch-action: none;
    }
    
    .admin-link-leh {
      display: flex;
      justify-content: center;
      align-items: center;
      color: #00b2ff;
      text-decoration: none;
      margin-bottom: 8px;
      font-weight: bold;
    }
    
    .admin-link-leh svg{
      width: 20px;
      height: 20px;
      margin-right: 8px;
      fill: #00b2ff;
    }
    
    a {
      align-items: center;
      font-weight: bold;
      font-size: 1.1em;
      padding: 10px 16px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.75);
      transition: background 0.3s ease;
    }
    
    footer {
      text-align: center;
      padding: 10px;
      color: black;
      font-size: 0.9rem;
      background: rgba(255, 255, 255, 0.7);
    }
    
    /* Hide game assets */
    #layer1, #layer2, #layer3, #layer4, #player, #cow, 
    #backingtrack_music, #sound_gaz, #sound_stop {
      display: none;
    }

    .game-info {
      margin-top: 20px;
      text-align: center;
    }

    .control-hint {
      text-align: center;
      margin-top: 10px;
      font-size: 0.9em;
      color: #ccc;
    }
  </style>
</head>
<body>
  <header>
    <h1>–ò–≥—Ä–∞ "Ladakh Rider" –æ—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ "–ö—Ç–æ –≤ –õ–µ—Ö, –∫—Ç–æ –ø–æ –¥—Ä–æ–≤–∞?"</h1><br>
    <a href="https://t.me/leh_ladak" class="admin-link-leh" target="_blank" rel="noopener noreferrer">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.963 7.57l-1.79 8.427c-.135.582-.485.726-1.008.452l-2.792-2.063-1.346 1.296c-.148.147-.271.271-.555.271l.2-2.869 5.217-4.71c.226-.2-.05-.312-.35-.112l-6.453 4.063-2.773-.865c-.602-.185-.613-.602.127-.89l10.843-4.18c.503-.185.944.112.783.883z"/></svg>
      –ù–∞—à Telegram-–∫–∞–Ω–∞–ª
    </a>
    <a href="../index.html" class="admin-link-leh" rel="noopener noreferrer">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.963 7.57l-1.79 8.427c-.135.582-.485.726-1.008.452l-2.792-2.063-1.346 1.296c-.148.147-.271.271-.555.271l.2-2.869 5.217-4.71c.226-.2-.05-.312-.35-.112l-6.453 4.063-2.773-.865c-.602-.185-.613-.602.127-.89l10.843-4.18c.503-.185.944.112.783.883z"/></svg>
      –ù–∞ –≥–ª–∞–≤–Ω—É—é
    </a>
  </header>
  
  <main>
    <section>
      <h2>–ì–æ–Ω–∫–∏ –ø–æ –õ–∞–¥–∞–∫—Ö—É</h2>
      <p>–ü—Ä–æ–∫–∞—Ç–∏—Ç–µ—Å—å –Ω–∞ –º–æ—Ç–æ—Ü–∏–∫–ª–µ –ø–æ –∂–∏–≤–æ–ø–∏—Å–Ω—ã–º –¥–æ—Ä–æ–≥–∞–º –õ–∞–¥–∞–∫—Ö–∞! –£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å—Ç—Ä–µ–ª–∫–∞–º–∏ –∏–ª–∏ –Ω–∞–∫–ª–æ–Ω–∞–º–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞.</p>
      
      <div class="game-container">
        <canvas id="canvas1"></canvas>
      </div>
      
      <div class="control-hint">
        üì± –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ù–∞–∫–ª–æ–Ω–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω –≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ –¥–ª—è –ø–æ–≤–æ—Ä–æ—Ç–æ–≤
      </div>
      
      <div class="game-info">
        <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: —Å—Ç—Ä–µ–ª–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (‚Üë‚Üì‚Üê‚Üí) –∏–ª–∏ –Ω–∞–∫–ª–æ–Ω—ã —Ç–µ–ª–µ—Ñ–æ–Ω–∞</p>
        <p>–ò–∑–±–µ–≥–∞–π—Ç–µ –∫–æ—Ä–æ–≤ –Ω–∞ –¥–æ—Ä–æ–≥–µ! –ü–æ—Å–ª–µ 19 —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π –∏–≥—Ä–∞ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è.</p>
      </div>
    </section>
  </main>
  
  <footer>
    &copy; 2025 –ö—Ç–æ –≤ –õ–µ—Ö, –∫—Ç–æ –ø–æ –¥—Ä–æ–≤–∞?
  </footer>
  
  <!-- Game assets (hidden) -->
  <audio id="backingtrack_music" src="african-rock-game.mp3"></audio>
  <audio id="sound_gaz" src="gaz-moto.mp3"></audio>
  <audio id="sound_stop" src="stopping-moto.mp3"></audio>
  
  <img id="player" src="player.png">
  <img id="cow" src="cow.png">
  <img id="layer1" src="layer1.png">
  <img id="layer2" src="layer2.png">
  <img id="layer3" src="layer3.png">
  <img id="layer4" src="layer4.png">

  <script>
    window.addEventListener('load', function() {
        const canvas = document.getElementById('canvas1');
        const ctx = canvas.getContext('2d');
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã canvas –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º
        function resizeCanvas() {
            const container = canvas.parentElement;
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–∞–∑–º–µ—Ä—ã canvas
        resizeCanvas();
        
        // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        window.addEventListener('resize', resizeCanvas);
        
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–∞—Å–∞–Ω–∏—è –Ω–∞ canvas
        canvas.addEventListener('touchstart', function(e) {
          e.preventDefault();
        }, { passive: false });
        
        canvas.addEventListener('touchmove', function(e) {
          e.preventDefault();
        }, { passive: false });
        
        canvas.addEventListener('touchend', function(e) {
          e.preventDefault();
        }, { passive: false });

        class Layer {
            constructor(game, image, speedModifier) {
                this.game = game;
                this.image = image;
                this.speedModifier = speedModifier;
                this.width = 1768;
                this.height = 500;
                this.x = 0;
                this.y = 0;
            }
            update() {
                if (this.x <= -this.width) this.x = 0;
                else this.x -= this.game.speed * this.speedModifier;
            }
            draw(context) {
                context.drawImage(this.image, this.x, this.y, this.width, this.height);
                context.drawImage(this.image, this.x + this.width, this.y, this.width, this.height);
            }
        }

        class Music {
            constructor(game) {
                this.game = game;
                this.media = document.getElementById('backingtrack_music');
                this.sound_gaz = document.getElementById('sound_gaz');
                this.sound_stop = document.getElementById('sound_stop');
                this.media.volume = 0.5;
                this.sound_gaz.volume = 0.3;
                this.sound_stop.volume = 0.3;
            }
        }

        class Background {
            constructor(game) {
                this.game = game;
                this.image1 = document.getElementById('layer1');
                this.image2 = document.getElementById('layer2');
                this.image3 = document.getElementById('layer3');
                this.image4 = document.getElementById('layer4');
                this.layer1 = new Layer(this.game, this.image1, 0.2);
                this.layer2 = new Layer(this.game, this.image2, 0.5);
                this.layer3 = new Layer(this.game, this.image3, 1);
                this.layer4 = new Layer(this.game, this.image4, 1.7);
                this.layers = [this.layer1, this.layer2, this.layer3];
            }
            update() {
                this.layers.forEach(layer => layer.update());
            }
            draw(context) {
                this.layers.forEach(layer => layer.draw(context));
            }
        }

        class Cow {
            constructor(game) {
                this.game = game;
                this.image = document.getElementById('cow');
                
                this.spriteWidth = 1024;
                this.spriteHeight = 1024;
                this.frameWidth = this.spriteWidth / 2;
                this.frameHeight = this.spriteHeight / 2;
                
                this.width = 80;
                this.height = 80;
                
                this.speed = Math.random() * 2 + 0.5;
                this.x = this.game.width + Math.random() * 200;
                
                const minY = 50;
                const maxY = this.game.height - this.height - 50;
                this.y = Math.random() * (maxY - minY) + minY;
                
                this.markedForDeletion = false;
                
                this.frameX = 0;
                this.frameY = 0;
                this.currentFrame = 0;
                this.totalFrames = 4;
                this.frameTimer = 0;
                this.frameInterval = 150 + Math.random() * 100;
            }
            
            update(deltaTime) {
                this.x -= this.speed + this.game.speed;
                
                if (this.x < -this.width) {
                    this.markedForDeletion = true;
                }
                
                if (this.game.checkCollision(this, this.game.player)) {
                    this.game.hitCow();
                    this.markedForDeletion = true;
                }
                
                if (this.frameTimer > this.frameInterval) {
                    this.currentFrame = (this.currentFrame + 1) % this.totalFrames;
                    this.frameX = this.currentFrame % 2;
                    this.frameY = Math.floor(this.currentFrame / 2);
                    this.frameTimer = 0;
                } else {
                    this.frameTimer += deltaTime;
                }
            }
            
            draw(context) {
                context.drawImage(
                    this.image,
                    this.frameX * this.frameWidth,
                    this.frameY * this.frameHeight,
                    this.frameWidth,
                    this.frameHeight,
                    this.x,
                    this.y,
                    this.width,
                    this.height
                );
            }
        }
        
        class CowSpawner {
            constructor(game) {
                this.game = game;
                this.cows = [];
                this.spawnTimer = 0;
                this.spawnInterval = 1500;
            }
            
            update(deltaTime) {
                if (this.spawnTimer > this.spawnInterval) {
                    this.cows.push(new Cow(this.game));
                    this.spawnTimer = 0;
                    this.spawnInterval = 1000 + Math.random() * 2000;
                } else {
                    this.spawnTimer += deltaTime;
                }
                
                this.cows.forEach(cow => cow.update(deltaTime));
                this.cows = this.cows.filter(cow => !cow.markedForDeletion);
            }
            
            draw(context) {
                this.cows.forEach(cow => cow.draw(context));
            }
        }

        class InputHandler {
            constructor(game) {
                this.game = game;
                
                // –ù–ê–°–¢–†–û–ô–ö–ò –î–õ–Ø –ö–û–ú–§–û–†–¢–ù–û–ì–û –£–ü–†–ê–í–õ–ï–ù–ò–Ø
                this.maxTiltSpeed = 4;
                this.tiltSensitivity = 0.03;
                this.returnToCenterSpeed = 0.1;
                
                // Keyboard controls
                window.addEventListener('keydown', e => {
                    if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'w', 'a', 's', 'd'].includes(e.key) &&
                        !this.game.keys.includes(e.key)) {
                        this.game.keys.push(e.key);
                    }
                });
                
                window.addEventListener('keyup', e => {
                    const index = this.game.keys.indexOf(e.key);
                    if (index > -1) {
                        this.game.keys.splice(index, 1);
                    }
                });

                // Gyroscope controls –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
                if (window.DeviceOrientationEvent) {
                    window.addEventListener('deviceorientation', (e) => {
                        // –ò—Å–ø–æ–ª—å–∑—É–µ–º gamma (–Ω–∞–∫–ª–æ–Ω –≤–ª–µ–≤–æ-–≤–ø—Ä–∞–≤–æ) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                        if (e.gamma !== null) {
                            this.game.tiltX = Math.max(-45, Math.min(45, e.gamma * this.tiltSensitivity));
                        }
                    });
                }

                // Touch controls –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
                let touchStartX = 0;
                let touchStartY = 0;
                
                canvas.addEventListener('touchstart', (e) => {
                    touchStartX = e.touches[0].clientX;
                    touchStartY = e.touches[0].clientY;
                    this.game.isTouching = true;
                });

                canvas.addEventListener('touchmove', (e) => {
                    if (!this.game.isTouching) return;
                    
                    const touchX = e.touches[0].clientX;
                    const touchY = e.touches[0].clientY;
                    
                    const deltaX = touchX - touchStartX;
                    const deltaY = touchY - touchStartY;
                    
                    // –ü–ª–∞–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Å–∞–Ω–∏–µ–º
                    this.game.touchControlX = Math.max(-1, Math.min(1, deltaX / 50));
                    this.game.touchControlY = Math.max(-1, Math.min(1, deltaY / 50));
                    
                    touchStartX = touchX;
                    touchStartY = touchY;
                });

                canvas.addEventListener('touchend', () => {
                    this.game.isTouching = false;
                    this.game.touchControlX = 0;
                    this.game.touchControlY = 0;
                });
            }

            update() {
                // –ü–ª–∞–≤–Ω–æ–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –∫ —Ü–µ–Ω—Ç—Ä—É –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                if (this.game.tiltX && !this.game.isTouching && !this.game.keys.length) {
                    if (this.game.tiltX > 0) {
                        this.game.tiltX = Math.max(0, this.game.tiltX - this.returnToCenterSpeed);
                    } else {
                        this.game.tiltX = Math.min(0, this.game.tiltX + this.returnToCenterSpeed);
                    }
                }
            }
        }

        class Player {
            constructor(game) {
                this.game = game;
                
                // –£–ú–ï–ù–¨–®–ï–ù–ù–´–ô –†–ê–ó–ú–ï–† –ò–ì–†–û–ö–ê
                this.originalWidth = 166;
                this.originalHeight = 215;
                this.width = this.originalWidth * 0.7;
                this.height = this.originalHeight * 0.7;
                
                // –ù–ê–ß–ê–õ–¨–ù–ê–Ø –ü–û–ó–ò–¶–ò–Ø - –¶–ï–ù–¢–† –≠–ö–†–ê–ù–ê
                this.x = 50;
                this.y = this.game.height / 2 - this.height / 2;
                
                // –ì–†–ê–ù–ò–¶–´ –î–í–ò–ñ–ï–ù–ò–Ø
                const margin = 50;
                this.xLimitRight = this.game.width - this.width - margin;
                this.xLimitLeft = margin;
                this.yLimitUp = margin;
                this.yLimitDown = this.game.height - this.height - margin;
                
                // –ù–ê–°–¢–†–û–ô–ö–ò –î–í–ò–ñ–ï–ù–ò–Ø –î–õ–Ø –ö–û–ú–§–û–†–¢–ù–û–ì–û –£–ü–†–ê–í–õ–ï–ù–ò–Ø
                this.speedX = 0;
                this.speedY = 0;
                this.maxSpeedX = 6;
                this.maxSpeedY = 3;
                this.acceleration = 0.15;
                this.deceleration = 0.08;
                
                this.image = document.getElementById('player');
                this.collisionCount = 0;
                
                // –î–ª—è –ø–ª–∞–≤–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏
                this.frameX = 0;
                this.frameY = 0;
                this.maxFrame = 2;
                this.frameTimer = 0;
                this.frameInterval = 100;
            }
            
            update(deltaTime) {
                let targetSpeedX = 0;
                let targetSpeedY = 0;
                
                // –ö–õ–ê–í–ò–ê–¢–£–†–ê - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
                if (this.game.keys.includes('ArrowLeft') || this.game.keys.includes('a')) {
                    targetSpeedX = -this.maxSpeedX;
                    this.game.sound_gaz_bool = false;
                    this.game.sound_stop_bool = true;
                } else if (this.game.keys.includes('ArrowRight') || this.game.keys.includes('d')) {
                    targetSpeedX = this.maxSpeedX;
                    this.game.sound_gaz_bool = true;
                    this.game.sound_stop_bool = false;
                }
                
                if (this.game.keys.includes('ArrowUp') || this.game.keys.includes('w')) {
                    targetSpeedY = -this.maxSpeedY;
                } else if (this.game.keys.includes('ArrowDown') || this.game.keys.includes('s')) {
                    targetSpeedY = this.maxSpeedY;
                }
                
                // –ì–ò–†–û–°–ö–û–ü - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–± —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º
                if (!this.game.keys.length && this.game.tiltX !== undefined) {
                    targetSpeedX = this.game.tiltX * this.maxSpeedX;
                    this.game.sound_gaz_bool = this.game.tiltX > 0;
                    this.game.sound_stop_bool = this.game.tiltX < 0;
                }
                
                // TOUCH CONTROL - –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
                if (!this.game.keys.length && this.game.tiltX === undefined && this.game.isTouching) {
                    targetSpeedX = this.game.touchControlX * this.maxSpeedX;
                    targetSpeedY = this.game.touchControlY * this.maxSpeedY;
                    this.game.sound_gaz_bool = this.game.touchControlX > 0;
                    this.game.sound_stop_bool = this.game.touchControlX < 0;
                }
                
                // –ü–õ–ê–í–ù–û–ï –ò–ó–ú–ï–ù–ï–ù–ò–ï –°–ö–û–†–û–°–¢–ò
                if (targetSpeedX !== 0) {
                    this.speedX += (targetSpeedX - this.speedX) * this.acceleration;
                } else {
                    this.speedX *= (1 - this.deceleration);
                }
                
                if (targetSpeedY !== 0) {
                    this.speedY += (targetSpeedY - this.speedY) * this.acceleration;
                } else {
                    this.speedY *= (1 - this.deceleration);
                }
                
                // –û–ì–†–ê–ù–ò–ß–ï–ù–ò–ï –°–ö–û–†–û–°–¢–ò
                this.speedX = Math.max(-this.maxSpeedX, Math.min(this.maxSpeedX, this.speedX));
                this.speedY = Math.max(-this.maxSpeedY, Math.min(this.maxSpeedY, this.speedY));
                
                // –î–í–ò–ñ–ï–ù–ò–ï
                this.x += this.speedX;
                this.y += this.speedY;
                
                // –ì–†–ê–ù–ò–¶–´
                this.x = Math.max(this.xLimitLeft, Math.min(this.xLimitRight, this.x));
                this.y = Math.max(this.yLimitUp, Math.min(this.yLimitDown, this.y));
                
                // –ï—Å–ª–∏ —Å–∫–æ—Ä–æ—Å—Ç—å –æ—á–µ–Ω—å –º–∞–ª–∞ - –æ–±–Ω—É–ª—è–µ–º –¥–ª—è –ø–æ–ª–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
                if (Math.abs(this.speedX) < 0.1) this.speedX = 0;
                if (Math.abs(this.speedY) < 0.1) this.speedY = 0;
                
                // –ê–ù–ò–ú–ê–¶–ò–Ø
                if (this.frameTimer > this.frameInterval) {
                    this.frameX = (this.frameX + 1) % (this.maxFrame + 1);
                    this.frameTimer = 0;
                } else {
                    this.frameTimer += deltaTime;
                }
            }
            
            draw(context) {
                // –†–∏—Å—É–µ–º –º–æ—Ç–æ—Ü–∏–∫–ª —Å –Ω–µ–±–æ–ª—å—à–∏–º –Ω–∞–∫–ª–æ–Ω–æ–º –≤ —Å—Ç–æ—Ä–æ–Ω—É –¥–≤–∏–∂–µ–Ω–∏—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–º–∞
                const rotation = this.speedX * 0.05;
                
                context.save();
                context.translate(this.x + this.width / 2, this.y + this.height / 2);
                context.rotate(rotation);
                
                context.drawImage(
                    this.image,
                    this.frameX * this.originalWidth,
                    this.frameY * this.originalHeight,
                    this.originalWidth,
                    this.originalHeight,
                    -this.width / 2,
                    -this.height / 2,
                    this.width,
                    this.height
                );
                
                context.restore();

                // –ó–í–£–ö–ò
                if (this.game.sound_gaz_bool) {
                    this.game.music.sound_gaz.play();
                    this.game.music.sound_stop.pause();
                } else if (this.game.sound_stop_bool) {
                    this.game.music.sound_stop.play();
                    this.game.music.sound_gaz.pause();
                } else {
                    this.game.music.sound_gaz.pause();
                    this.game.music.sound_stop.pause();
                }
            }
        }

        class Game {
            constructor(width, height) {
                this.width = width;
                this.height = height;
                this.background = new Background(this);
                this.player = new Player(this);
                this.music = new Music(this);
                this.input = new InputHandler(this);
                this.cowSpawner = new CowSpawner(this);
                
                this.keys = [];
                this.speed = 1;
                this.score = 0;
                this.sound_gaz_bool = false;
                this.sound_stop_bool = true;
                this.maxCollisions = 19;
                
                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–∏—Ä–æ—Å–∫–æ–ø–æ–º
                this.tiltX = 0;
                
                // Touch —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                this.isTouching = false;
                this.touchControlX = 0;
                this.touchControlY = 0;
                
                // Start music
                this.music.media.loop = true;
                this.music.media.play().catch(e => console.log('Autoplay prevented:', e));
            }
            
            checkCollision(object1, object2) {
                return (
                    object1.x < object2.x + object2.width &&
                    object1.x + object1.width > object2.x &&
                    object1.y < object2.y + object2.height &&
                    object1.y + object1.height > object2.y
                );
            }
            
            hitCow() {
                this.speed *= 0.8;
                this.player.collisionCount++;
                
                if (this.player.collisionCount >= this.maxCollisions) {
                    alert(`Game Over! –í—ã —Å–±–∏–ª–∏ ${this.player.collisionCount} –∫–æ—Ä–æ–≤! –í–∞—à —Å—á–µ—Ç: ${Math.floor(this.score)}`);
                    document.location.reload();
                }
            }
            
            update(deltaTime) {
                this.input.update();
                this.background.layer4.update();
                this.player.update(deltaTime);
                this.background.update();
                this.cowSpawner.update(deltaTime);
                
                // Score increases with time
                this.score += this.speed * 0.1;
                
                // Gradually restore speed after collision
                if (this.speed < 1) {
                    this.speed += 0.005;
                }
            }
            
            draw(context) {
                context.clearRect(0, 0, this.width, this.height);
                
                this.background.draw(context);
                this.cowSpawner.draw(context);
                this.player.draw(context);
                this.background.layer4.draw(context);
                
                // UI
                context.fillStyle = 'white';
                context.font = '20px Arial';
                context.fillText(`Score: ${Math.floor(this.score)}`, 20, 30);
                context.fillText(`Cows: ${this.player.collisionCount}/${this.maxCollisions}`, 20, 60);
                
                // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
                if (this.tiltX !== undefined) {
                    context.fillStyle = 'rgba(255,255,255,0.3)';
                    context.fillRect(this.width / 2 - 60, this.height - 40, 120, 20);
                    context.fillStyle = '#4CAF50';
                    context.fillRect(this.width / 2 - 60 + 60 + (this.tiltX * 50), this.height - 40, 10, 20);
                }
                
                // Health bar
                const healthWidth = 200;
                const healthHeight = 20;
                const healthX = this.width - healthWidth - 20;
                const healthY = 30;
                
                context.fillStyle = 'rgba(0,0,0,0.5)';
                context.fillRect(healthX, healthY, healthWidth, healthHeight);
                
                const healthPercent = 1 - (this.player.collisionCount / this.maxCollisions);
                if (healthPercent > 0.6) {
                    context.fillStyle = '#4CAF50';
                } else if (healthPercent > 0.3) {
                    context.fillStyle = '#FFC107';
                } else {
                    context.fillStyle = '#F44336';
                }
                
                context.fillRect(healthX, healthY, healthWidth * healthPercent, healthHeight);
                context.strokeStyle = 'white';
                context.strokeRect(healthX, healthY, healthWidth, healthHeight);
            }
        }
        
        const game = new Game(canvas.width, canvas.height);
        
        let lastTime = 0;
        function animate(timestamp) {
            const deltaTime = timestamp - lastTime;
            lastTime = timestamp;
            
            game.update(deltaTime);
            game.draw(ctx);
            requestAnimationFrame(animate);
        }
        
        animate(0);
    });
  </script>
</body>
</html>
