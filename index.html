<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="yandex-verification" content="f10bc1dcc02fc8ee" />
  <title>Ле, Ладакх. Русскоязычное сообщество путешественников в Гималаях и Тибете - "Кто в Лех, кто по дрова?"</title>
  <meta name="description" content="Сообщество русскоязычных путешественников в Гималаях, Тибете и Ладаке. Делимся опытом, фотографиями и советами." />
  <meta property="og:image" content="https://cdn.glitch.global/bea12857-f511-461d-adbc-da5b46687f87/IMG_20231118_212542_728.jpg?v=1750048499482">
  <link rel="icon" href="IMG_20231118_212542_728.ico" type="image/x-icon">
  <meta name="keywords" content="путешествия, Гималаи, Тибет, Ладак, туризм, русскоязычное сообщество, Кто в Лех, кто по дрова, Лех" />
  <meta name="google-site-verification" content="Vy_7IEiB5LnDvD_vopy0n6hge5lkuvSpSYA_0hAaePQ" />
  <link rel="canonical" href="https://leh-ladakh.onrender.com/" />
  <style>
    html {
      overflow-x: hidden;  
    }
    
    body {
      overflow-x: hidden;  
      margin: 0;
      font-family: 'Lora', serif;
      color: #fff;
      background: url('https://cdn.glitch.global/bea12857-f511-461d-adbc-da5b46687f87/IMG_20231118_212542_728.jpg?v=1750048499482') no-repeat center center fixed;
      background-size: cover;
      line-height: 1.6;
    }
    header {
      background: rgba(0, 0, 0, 0.6);
      padding: 20px;
      text-align: center;
    }
    h1 {
      margin: 0;
      font-size: 1.2rem;
    }
    h2, p {
      text-align: center;
    }
    main {
      background: rgba(0, 0, 0, 0.5);
      max-width: 900px;
      margin: 30px auto;
      padding: 20px;
      border-radius: 8px;
    }

    .gallery {
      display: flex;
      overflow-x: auto;
      gap: 10px;
      scroll-behavior: smooth;
      padding-bottom: 10px;
    }

    .gallery::-webkit-scrollbar {
      display: none;
    }

    .gallery img {
      flex: 0 0 auto;
      width: 150px;
      height: 120px;
      border-radius: 6px;
      object-fit: cover;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    
    .gallery img:hover {
      transform: scale(1.05);
    }
    
    .admins {
      text-align: center;
      margin-top: 20px;
    }
    
    .admin-link-leh {
      display: flex;
      justify-content: center;
      align-items: center;
      color: #00b2ff;
      text-decoration: none;
      margin-bottom: 8px;
      font-weight: bold;
      opacity: 0;
      animation: slideInFromRight 0.6s forwards;
    }
    
    .admin-link-leh svg{
      width: 20px;
      height: 20px;
      margin-right: 8px;
      fill: #00b2ff;
    }
    
    .admin-link {
      display: flex;
      justify-content: center;
      align-items: center;
      color: #00b2ff;
      text-decoration: none;
      margin-bottom: 8px;
      font-weight: bold;
      opacity: 0;
      animation: slideInFromRight 0.6s forwards;
    }
    
    .admin-link svg {
      width: 20px;
      height: 20px;
      margin-right: 8px;
      fill: #00b2ff;
    }
    
    a {
      align-items: center;
      font-weight: bold;
      font-size: 1.1em;
      padding: 10px 16px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.75);
      transition: background 0.3s ease;
    }
    
    @keyframes slideInFromRight {
      0% {
        opacity: 0;
        transform: translateX(50px);
      }
      100% {
        opacity: 1;
        transform: translateX(0);
      }
    }

    /* Animation delays for top buttons */
    .admin-link-leh:nth-child(4) { animation-delay: 0.5s; }
    .admin-link-leh:nth-child(5) { animation-delay: 1s; }
    .admin-link-leh:nth-child(6) { animation-delay: 1.5s; }
    .admin-link-leh:nth-child(7) { animation-delay: 2s; }

    /* Animation delays for bottom buttons */
    .admin-link:nth-child(2) { animation-delay: 1.5s; }
    .admin-link:nth-child(3) { animation-delay: 2s; }
    .admin-link:nth-child(4) { animation-delay: 2.5s; }
    .admin-link:nth-child(5) { animation-delay: 3s; }
    .admin-link:nth-child(6) { animation-delay: 3.5s; }
    
    iframe {
      width: 100%;
      height: 360px;
      border: none;
      border-radius: 8px;
      margin-top: 20px;
    }
    
    footer {
      text-align: center;
      padding: 10px;
      color: black;
      font-size: 0.9rem;
    }
    
    /* Modal styles for full-size gallery */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      overflow: hidden;
    }
    
    .modal-content {
      position: relative;
      margin: auto;
      display: block;
      width: 80%;
      max-width: 1200px;
      max-height: 80vh;
      top: 50%;
      transform: translateY(-50%);
    }
    
    .modal-image {
      width: 100%;
      height: auto;
      max-height: 80vh;
      object-fit: contain;
    }
    
    .modal-caption {
      text-align: center;
      color: #fff;
      padding: 10px;
      font-size: 1.2rem;
    }
    
    .close {
      position: absolute;
      top: 15px;
      right: 35px;
      color: #f1f1f1;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }
    
    .prev, .next {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      color: white;
      font-size: 30px;
      font-weight: bold;
      padding: 16px;
      cursor: pointer;
      background-color: rgba(0, 0, 0, 0.3);
      border-radius: 0 3px 3px 0;
      user-select: none;
      z-index: 1001;
    }
    
    .next {
      right: 0;
      border-radius: 3px 0 0 3px;
    }
    
    .prev:hover, .next:hover {
      background-color: rgba(0, 0, 0, 0.8);
    }
    
    /* Chat styles */
    .chat-container {
      margin-top: 30px;
      background: rgba(0, 0, 0, 0.6);
      border-radius: 8px;
      padding: 15px;
    }
    
    .chat-header {
      text-align: center;
      margin-bottom: 15px;
    }
    
    .chat-area {
      height: 200px;
      overflow-y: auto;
      background: rgba(255, 255, 255, 0.1);
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 10px;
    }
    
    .message {
      margin-bottom: 10px;
      padding: 8px;
      border-radius: 5px;
      background: rgba(0, 0, 0, 0.3);
    }
    
    .chat-inputs {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .chat-inputs input {
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #444;
      background: rgba(255, 255, 255, 0.1);
      color: white;
    }
    
    .chat-buttons {
      display: flex;
      gap: 8px;
      margin-top: 10px;
    }
    
    .chat-buttons button {
      flex: 1;
      padding: 8px;
      border-radius: 5px;
      border: none;
      background: #00b2ff;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }
    
    .chat-buttons button:hover {
      background: #0099cc;
    }
  </style>
</head>
<body>
  <header>
    <h1>Ле, Ладакх. Русскоязычное сообщество путешественников в Гималаях и Тибете - "Кто в Лех, кто по дрова?"</h1><br>
      <a href="https://t.me/leh_ladak" class="admin-link-leh" target="_blank" rel="noopener noreferrer">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.963 7.57l-1.79 8.427c-.135.582-.485.726-1.008.452l-2.792-2.063-1.346 1.296c-.148.147-.271.271-.555.271l.2-2.869 5.217-4.71c.226-.2-.05-.312-.35-.112l-6.453 4.063-2.773-.865c-.602-.185-.613-.602.127-.89l10.843-4.18c.503-.185.944.112.783.883z"/></svg>
        Кто в Лех, кто по дрова?
      </a>
      <a href="map-points.html" class="admin-link-leh" target="_blank" rel="noopener noreferrer">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.963 7.57l-1.79 8.427c-.135.582-.485.726-1.008.452l-2.792-2.063-1.346 1.296c-.148.147-.271.271-.555.271l.2-2.869 5.217-4.71c.226-.2-.05-.312-.35-.112l-6.453 4.063-2.773-.865c-.602-.185-.613-.602.127-.89l10.843-4.18c.503-.185.944.112.783.883z"/></svg>
        Карта Ладака / Места
      </a>
      <a href="game/game.html" class="admin-link-leh" target="_blank" rel="noopener noreferrer">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.963 7.57l-1.79 8.427c-.135.582-.485.726-1.008.452l-2.792-2.063-1.346 1.296c-.148.147-.271.271-.555.271l.2-2.869 5.217-4.71c.226-.2-.05-.312-.35-.112l-6.453 4.063-2.773-.865c-.602-.185-.613-.602.127-.89l10.843-4.18c.503-.185.944.112.783.883z"/></svg>
        Игра (в разработке)
      </a>
      <a href="game/rules.html" class="admin-link-leh" target="_blank" rel="noopener noreferrer">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.963 7.57l-1.79 8.427c-.135.582-.485.726-1.008.452l-2.792-2.063-1.346 1.296c-.148.147-.271.271-.555.271l.2-2.869 5.217-4.71c.226-.2-.05-.312-.35-.112l-6.453 4.063-2.773-.865c-.602-.185-.613-.602.127-.89l10.843-4.18c.503-.185.944.112.783.883z"/></svg>
        Правила группы
      </a>
      <a href="https://ship-spb.onrender.com/friends" class="admin-link-leh" target="_blank" rel="noopener noreferrer">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.963 7.57l-1.79 8.427c-.135.582-.485.726-1.008.452l-2.792-2.063-1.346 1.296c-.148.147-.271.271-.555.271l.2-2.869 5.217-4.71c.226-.2-.05-.312-.35-.112l-6.453 4.063-2.773-.865c-.602-.185-.613-.602.127-.89l10.843-4.18c.503-.185.944.112.783.883z"/></svg>
        Друзья и партнеры
      </a>
  </header>
  <main>
    <section>
      <p>
        Добро пожаловать в наше сообщество русскоязычных путешественников "Кто в Лех, кто по дрова?", исследующих красоты Гималаев, Тибета и Ладака.
        Здесь мы делимся советами, фотографиями, впечатлениями и планируем совместные маршруты.
      </p>
    </section>

    <section class="gallery" aria-label="Галерея фотографий путешествий">
      <img src="https://cdn.glitch.global/bea12857-f511-461d-adbc-da5b46687f87/IMG_20230701_165959_395.jpg?v=1750048521450" alt="Гималаи в облаках" />
      <img src="https://cdn.glitch.global/bea12857-f511-461d-adbc-da5b46687f87/IMG_20230619_205316_241.JPG?v=1750048549299" alt="Монастырь в Тибете" />
      <img src="https://cdn.glitch.global/bea12857-f511-461d-adbc-da5b46687f87/IMG_20231118_212542_728.jpg?v=1750048499482" alt="Пейзаж Ладака" />
      <img src="https://cdn.glitch.global/bea12857-f511-461d-adbc-da5b46687f87/IMG_20230701_165958_751.jpg?v=1750048532392" alt="Путь в Гималаях" />
      <img src="https://cdn.glitch.global/bea12857-f511-461d-adbc-da5b46687f87/IMG_20231119_225703_570.jpg?v=1750065165611" alt="Кто в Лех, кто по дрова?" />
      <img src="https://cdn.glitch.global/bea12857-f511-461d-adbc-da5b46687f87/IMG_20240820_212616_914.jpg?v=1750065154220" alt="Кто в Лех, кто по дрова?" />
      <img src="https://cdn.glitch.global/bea12857-f511-461d-adbc-da5b46687f87/IMG_20240820_205718_876.jpg?v=1750065179799" alt="Тибетская бабка" />
      <img src="https://cdn.glitch.global/bea12857-f511-461d-adbc-da5b46687f87/IMG_20240820_212859_318.jpg?v=1750063481747" alt="Закат в Тибете" />
    </section>

    <section>
      <h2>Небольшой документальный фильм о наших путешествиях в Гималаях</h2>
      <iframe width="560" height="315" src="https://www.youtube.com/embed/xexOO3cu9dw?si=-9bJoaCjbT_D0dc0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    </section>

    <!-- Chat Section -->
    <section class="chat-container">
      <div class="chat-header">
        <h2>Чат сообщества</h2>
      </div>
      <div id="chat-area" class="chat-area">
        <!-- Messages will be displayed here -->
      </div>
      <div class="chat-inputs">
        <input type="text" id="user-name-input" placeholder="Ваше имя">
        <input type="text" id="message-input" placeholder="Ваше сообщение">
      </div>
      <div class="chat-buttons">
        <button id="send-btn">Отправить</button>
        <button id="refresh-btn">Обновить</button>
<script>/*
        <button id="delete-btn" style="background: #ff4757;">Очистить</button>    
*/</script>
      </div>
    </section>    

    <section class="admins" aria-label="Администраторы сообщества в Telegram">
      <h2>Администраторы группы в Telegram</h2>
      <a href="https://t.me/tashtashnatash72" class="admin-link" target="_blank" rel="noopener noreferrer">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.963 7.57l-1.79 8.427c-.135.582-.485.726-1.008.452l-2.792-2.063-1.346 1.296c-.148.147-.271.271-.555.271l.2-2.869 5.217-4.71c.226-.2-.05-.312-.35-.112l-6.453 4.063-2.773-.865c-.602-.185-.613-.602.127-.89l10.843-4.18c.503-.185.944.112.783.883z"/></svg>
        tashtashnatash
      </a>
      <a href="https://t.me/noOneNoOther" class="admin-link" target="_blank" rel="noopener noreferrer">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.963 7.57l-1.79 8.427c-.135.582-.485.726-1.008.452l-2.792-2.063-1.346 1.296c-.148.147-.271.271-.555.271l.2-2.869 5.217-4.71c.226-.2-.05-.312-.35-.112l-6.453 4.063-2.773-.865c-.602-.185-.613-.602.127-.89l10.843-4.18c.503-.185.944.112.783.883z"/></svg>
        No One
      </a>
      <a href="https://t.me/Maksimka4696" class="admin-link" target="_blank" rel="noopener noreferrer">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.963 7.57l-1.79 8.427c-.135.582-.485.726-1.008.452l-2.792-2.063-1.346 1.296c-.148.147-.271.271-.555.271l.2-2.869 5.217-4.71c.226-.2-.05-.312-.35-.112l-6.453 4.063-2.773-.865c-.602-.185-.613-.602.127-.89l10.843-4.18c.503-.185.944.112.783.883z"/></svg>
        Max Collapse
      </a>
      <a href="https://t.me/iNatt" class="admin-link" target="_blank" rel="noopener noreferrer">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.963 7.57l-1.79 8.427c-.135.582-.485.726-1.008.452l-2.792-2.063-1.346 1.296c-.148.147-.271.271-.555.271l.2-2.869 5.217-4.71c.226-.2-.05-.312-.35-.112l-6.453 4.063-2.773-.865c-.602-.185-.613-.602.127-.89l10.843-4.18c.503-.185.944.112.783.883z"/></svg>
        iNat
      </a>
      <a href="https://t.me/l_obs" class="admin-link" target="_blank" rel="noopener noreferrer">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.963 7.57l-1.79 8.427c-.135.582-.485.726-1.008.452l-2.792-2.063-1.346 1.296c-.148.147-.271.271-.555.271l.2-2.869 5.217-4.71c.226-.2-.05-.312-.35-.112l-6.453 4.063-2.773-.865c-.602-.185-.613-.602.127-.89l10.843-4.18c.503-.185.944.112.783.883z"/></svg>
        Sergey F
      </a>
    </section>
  </main>
  <footer>
    &copy; 2025 Кто в Лех, кто по дрова?
  </footer>

  <!-- Modal for full-size gallery -->
  <div id="galleryModal" class="modal">
    <span class="close">&times;</span>
    <span class="prev">&#10094;</span>
    <span class="next">&#10095;</span>
    <div class="modal-content">
      <img class="modal-image" id="modalImg">
      <div class="modal-caption" id="caption"></div>
    </div>
  </div>

  <script>
    // Gallery modal functionality
    const modal = document.getElementById("galleryModal");
    const modalImg = document.getElementById("modalImg");
    const captionText = document.getElementById("caption");
    const closeBtn = document.getElementsByClassName("close")[0];
    const prevBtn = document.getElementsByClassName("prev")[0];
    const nextBtn = document.getElementsByClassName("next")[0];
    
    // Get all gallery images
    const galleryImages = document.querySelectorAll('.gallery img');
    let currentIndex = 0;
    
    // Open modal when clicking on an image
    galleryImages.forEach((img, index) => {
      img.addEventListener('click', () => {
        currentIndex = index;
        openModal();
      });
    });
    
    function openModal() {
      modal.style.display = "block";
      updateModalImage();
      
      // Prevent background scrolling when modal is open
      document.body.style.overflow = "hidden";
    }
    
    function updateModalImage() {
      modalImg.src = galleryImages[currentIndex].src;
      captionText.innerHTML = galleryImages[currentIndex].alt;
    }
    
    // Close modal
    closeBtn.onclick = function() {
      modal.style.display = "none";
      document.body.style.overflow = "auto"; // Re-enable scrolling
    }
    
    // Navigate to previous image
    prevBtn.onclick = function(e) {
      e.stopPropagation();
      currentIndex = (currentIndex - 1 + galleryImages.length) % galleryImages.length;
      updateModalImage();
    }
    
    // Navigate to next image
    nextBtn.onclick = function(e) {
      e.stopPropagation();
      currentIndex = (currentIndex + 1) % galleryImages.length;
      updateModalImage();
    }
    
    // Close modal when clicking outside the image
    modal.onclick = function(event) {
      if (event.target === modal) {
        modal.style.display = "none";
        document.body.style.overflow = "auto";
      }
    }
    
    // Keyboard navigation
    document.addEventListener('keydown', function(event) {
      if (modal.style.display === "block") {
        if (event.key === "Escape") {
          modal.style.display = "none";
          document.body.style.overflow = "auto";
        } else if (event.key === "ArrowLeft") {
          currentIndex = (currentIndex - 1 + galleryImages.length) % galleryImages.length;
          updateModalImage();
        } else if (event.key === "ArrowRight") {
          currentIndex = (currentIndex + 1) % galleryImages.length;
          updateModalImage();
        }
      }
    });
    
    // Chat functionality
    let pageSize = 100; // Number of records per page
    let currentPage = 1; // Start from the first page
    let data_messages = []; 
    let secret_key_server = '123';

    // Load the username from localStorage when the page loads
    window.onload = function() {
        const savedUsername = localStorage.getItem('username');
        if (savedUsername) {
            document.getElementById('user-name-input').value = savedUsername;
        }
        fetchMessages();
        setInterval(fetchMessages, 25000); // Fetch every 25 seconds (25000 milliseconds)
    };

    function simpleEncrypt(data, key) {
      let encryptedData = '';
      let j = 0;
      
      // Iterate through each character of the data
      for (let i = 0; i < data.length; i++) {
        // Add a random character before the current character every 1st symbol
        let randomChar = String.fromCharCode(Math.floor(Math.random() * 94) + 32); 
        if (j >=key.length) {j=0;}
        // Check if the random character is '*' and change it to '$' , * - symbol separator in file
        if (randomChar === '*') {
            randomChar = '$';
        }
        encryptedData += randomChar;

        // Add the current character from the data
        let unicodeCurrentChar = data[i].charCodeAt(0);
        let unicodeCurrentKeyChar = key[j].charCodeAt(0);
        let encryptedChar = String.fromCharCode(unicodeCurrentKeyChar+unicodeCurrentChar);
        encryptedData += encryptedChar;
        j++;
      }

      return encryptedData;
    }

    function simpleDecrypt(data, key) {
        let decryptedData = '';
        let j = 0;

        // Iterate through the modified data
        for (let i = 0; i < data.length; i++) {
            if (j >= key.length) {
                j = 0;
            }
            // Skip every first symbol (i.e., indices 0, 2, 4, 6, ...)
            if (i % 2 === 0) {
                continue;  // Skip this byte (this is where the random character was added during encryption)
            }
            let unicodeCurrentChar = data.charCodeAt(i); // Get the Unicode value of the encrypted character
            let unicodeCurrentKeyChar = key[j].charCodeAt(0); // Get the Unicode value of the key character
            let decryptedChar = String.fromCharCode(unicodeCurrentChar - unicodeCurrentKeyChar); // Decrypt the character
            // Append the character to decryptedData
            decryptedData += decryptedChar;
            j++;
        }
        return decryptedData;
    }

    function stringToColor(str) {
        let hash = 0;
        for (let i = 0; i < str.length; i++) {
            hash = str.charCodeAt(i) + ((hash << 5) - hash);
        }
        const color = (hash & 0x00FFFFFF)
            .toString(16)
            .toUpperCase()
            .padStart(6, '0');
        return `#${color}`;
    }

    function fetchMessages() {
        const url = `https://focusedbadge-us.backendless.app/api/data/messy_buggy?pageSize=${pageSize}&page=${currentPage}`;
        const headers = {
            'Content-Type': 'application/json',
            'Accept': 'application/json',
            'application-id': '99451B96-0AE0-4556-A88D-84D2500E2AC5',
            'api-key': 'E502729E-2312-47D4-9AF5-9084CDEAB1C7'
        };

        fetch(url, { method: 'GET', headers: headers })
            .then(response => {
                if (!response.ok) {
                    console.log(currentPage);
                    throw new Error('Failed to fetch data: ' + response.statusText);
                }
                return response.json();
            })
            .then(data => {
                data_messages = data;
                console.log("Fetched data:", data);

                // Get the chat area element
                const chatArea = document.getElementById('chat-area');
                chatArea.innerHTML = "";

                // Sort and display the messages
                data.sort((a, b) => new Date(b.created) - new Date(a.created));

                data.forEach(record => {
                    const messageElement = document.createElement('div');
                    messageElement.classList.add('message');

                    // Generate a color for the user based on their username
                    const userColor = stringToColor(record.user);

                    // Set the background color for each message
                    messageElement.style.backgroundColor = userColor;
                    const userKey = '123';  // Get the inputted key
                    let messageContent = '';
                    
                    
                        const decryptedMessage = simpleDecrypt(record.message, '123');
                        messageContent = `
                        <p><strong>${record.user}</strong>: ${decryptedMessage}</p>
                        <small>Sent at: ${record.time_date_stamp}</small>
                        <hr>`;
                        console.log(messageContent);

                    messageElement.innerHTML = messageContent;
                    chatArea.appendChild(messageElement);
                });

                // Check if there are more messages to fetch (i.e., data.length < pageSize)
                if (data.length === pageSize) {
                    currentPage++;  // Move to the next page
                }
            })
            .catch(error => {
                console.error("Error:", error);
            });
    }

    function sendAndsaveMessage() {
        // Get the value from the message input field
        const field_message = document.getElementById('message-input').value;

        // Get the value from the username input field
        const field_username = document.getElementById('user-name-input').value;

        // Check if the message is not empty and username is provided
        if (field_message.trim() === "") {
            console.error("Message cannot be empty.");
            return;
        }
        if (field_username.trim() === "") {
            console.error("Username cannot be empty.");
            return;
        }

        // Save the username to localStorage
        localStorage.setItem('username', field_username);

        const encrypted_field_message = simpleEncrypt(field_message, secret_key_server);

        // Data you want to send (message and username)
        const dataToUpdate = {
            message: encrypted_field_message, // Use the message from the input field
            user: field_username,   // Use the username from the input field
            time_date_stamp: new Date().toISOString() // Timestamp for when the message is sent
        };

        
        const url = "https://focusedbadge-us.backendless.app/api/data/messy_buggy"; // Backendless API endpoint

        // Headers for the POST request
        const headers = {
            'Content-Type': 'application/json',
            'Accept': 'application/json',
            'application-id': '99451B96-0AE0-4556-A88D-84D2500E2AC5',  // Your App ID
            'api-key': 'E502729E-2312-47D4-9AF5-9084CDEAB1C7'             // Your JS API Key
        };

        // Making the POST request using fetch
        fetch(url, {
            method: 'POST', // Changed to POST since you're adding a new message
            headers: headers,
            body: JSON.stringify(dataToUpdate)  // Convert the data to JSON string
        })
        .then(response => {
            if (!response.ok) {
                console.log(dataToUpdate);
                throw new Error('Failed to update data: ' + response.statusText);
            }
            return response.json();  // Parse the response JSON
        })
        .then(data => {
            console.log("Response Data:", data);  // Handle the response data after update
            // Clear the input fields after the message is sent
            document.getElementById('message-input').value = "";

            // Fetch updated messages
            fetchMessages();
        })
        .catch(error => {
            console.error("Error:", error);  // Handle any errors that occur during the request
        });
    }

    function deleteMessages() {
        // Assuming the API supports deleting messages by objectId using the DELETE method.
        const messageIdsToDelete = [];
        data = data_messages;

        // Here, let's assume you want to delete the first 10 messages from the fetched data.
        // You can modify this logic to delete based on any condition you prefer.
        data.slice(0, 10).forEach(record => {
            messageIdsToDelete.push(record.objectId);  // Assuming objectId is the identifier of the message
            console.log(record.objectId);
        });

        if (messageIdsToDelete.length === 0) {
            console.log("No messages to delete.");
            return;
        }

        // Loop over each message ID and delete them using DELETE method
        messageIdsToDelete.forEach(id => {
            const url = `https://focusedbadge-us.backendless.app/api/data/messy_buggy/${id}`;  // Delete endpoint with message ID
            const headers = {
                'Content-Type': 'application/json',
                'Accept': 'application/json',
                'application-id': '99451B96-0AE0-4556-A88D-84D2500E2AC5',
                'api-key': 'E502729E-2312-47D4-9AF5-9084CDEAB1C7'
            };

            fetch(url, { method: 'DELETE', headers: headers })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to delete message with ID ' + id + ': ' + response.statusText);
                    }
                    console.log(`Message with ID ${id} deleted successfully.`);
                })
                .catch(error => {
                    console.error("Error deleting message:", error);
                });
        });

        // After deleting, you may want to refresh the messages or update the chat
        fetchMessages();  // Re-fetch messages to show updated chat
    }

    document.getElementById('send-btn').addEventListener('click', sendAndsaveMessage);
    document.getElementById('refresh-btn').addEventListener('click', fetchMessages);
    document.getElementById('delete-btn').addEventListener('click', deleteMessages);
  </script>
</body>
</html>
