<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ö–∞—Ä—Ç–∞ –õ–∞–¥–∞–∫—Ö–∞ ‚Äî –í–∞—à–∏ –º–µ—Å—Ç–∞</title>
  <meta name="description" content="–°–æ–æ–±—â–µ—Å—Ç–≤–æ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã—Ö –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤ –≤ –ì–∏–º–∞–ª–∞—è—Ö, –¢–∏–±–µ—Ç–µ –∏ –õ–∞–¥–∞–∫–µ. –î–µ–ª–∏–º—Å—è –æ–ø—ã—Ç–æ–º, —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ –∏ —Å–æ–≤–µ—Ç–∞–º–∏." />
  <meta property="og:image" content="https://cdn.glitch.global/bea12857-f511-461d-adbc-da5b46687f87/IMG_20231118_212542_728.jpg?v=1750048499482">
  <link rel="icon" href="IMG_20231118_212542_728.ico" type="image/x-icon">
  <meta name="keywords" content="–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è, –ì–∏–º–∞–ª–∞–∏, –¢–∏–±–µ—Ç, –õ–∞–¥–∞–∫, —Ç—É—Ä–∏–∑–º, —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ, –ö—Ç–æ –≤ –õ–µ—Ö, –∫—Ç–æ –ø–æ –¥—Ä–æ–≤–∞, –õ–µ—Ö" />
  <meta name="google-site-verification" content="Vy_7IEiB5LnDvD_vopy0n6hge5lkuvSpSYA_0hAaePQ" />
  <link rel="canonical" href="https://leh-ladakh.onrender.com/" />
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
  body {
    margin: 0;
    font-family: 'Lora', serif;
    background: url('https://cdn.glitch.global/bea12857-f511-461d-adbc-da5b46687f87/IMG_20231118_212542_728.jpg?v=1750048499482') no-repeat center center fixed;
    background-size: cover;
    color: #fff;
  }
  header {
    background: rgba(0,0,0,0.6);
    padding: 20px;
    text-align: center;
  }
  h1 { margin: 0; font-size: 1.2rem; }
  main {
    background: rgba(0,0,0,0.6);
    max-width: 900px;
    margin: 30px auto;
    padding: 20px;
    border-radius: 8px;
  }
  #map { height: 600px; width: 100%; border-radius: 8px; margin-top: 20px; position: relative; }
  .upload-section, .action-buttons, .stats, .info {
    background: rgba(255,255,255,0.1);
    padding: 15px;
    border-radius: 8px;
    margin: 15px 0;
  }
  .upload-section input[type="file"] { width: 100%; padding: 8px; margin-top: 10px; border-radius: 5px; border: none; }
  .action-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
  }
  .action-buttons button {
    margin: 5px;
    padding: 10px 15px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    flex: 1;
    min-width: 200px;
  }
  .save-btn { background: #27ae60; color: white; }
  .orange { background: #f39c12; color: white; }
  .clear-btn { background: #e74c3c; color: white; }
  .delete-all-btn { background: #8e44ad; color: white; }
  .food-btn { background: #e67e22; color: white; }
  .places-list-item { 
    margin: 5px 0; 
    padding: 8px; 
    background: rgba(255,255,255,0.15); 
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s;
  }
  .places-list-item:hover {
    background: rgba(255,255,255,0.25);
  }
  .map-controls {
    position: absolute;
    top: 10px;
    right: 10px;
    z-index: 1000;
    background: rgba(0,0,0,0.7);
    padding: 10px;
    border-radius: 5px;
    display: flex;
    flex-direction: column;
    gap: 5px;
  }
  .map-controls button {
    background: rgba(255,255,255,0.2);
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.3s;
  }
  .map-controls button:hover {
    background: rgba(255,255,255,0.3);
  }
  .place-type {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    margin-left: 10px;
    color: white;
  }
  .type-custom {
    background: #27ae60;
  }
  .type-default {
    background: #3498db;
  }
  .type-food {
    background: #e67e22;
  }
  
  /* –°—Ç–∏–ª–∏ –∫–Ω–æ–ø–æ–∫ –∫–∞–∫ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ */
  .admin-link-leh {
    display: flex;
    justify-content: center;
    align-items: center;
    color: #00b2ff;
    text-decoration: none;
    margin-bottom: 8px;
    font-weight: bold;
    opacity: 0;
    animation: slideInFromRight 0.6s forwards;
  }
  
  .admin-link-leh svg{
    width: 20px;
    height: 20px;
    margin-right: 8px;
    fill: #00b2ff;
  }
  
  .admin-link {
    display: flex;
    justify-content: center;
    align-items: center;
    color: #00b2ff;
    text-decoration: none;
    margin-bottom: 8px;
    font-weight: bold;
    opacity: 0;
    animation: slideInFromRight 0.6s forwards;
  }
  
  .admin-link svg {
    width: 20px;
    height: 20px;
    margin-right: 8px;
    fill: #00b2ff;
  }
  
  a {
    align-items: center;
    font-weight: bold;
    font-size: 1.1em;
    padding: 10px 16px;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.75);
    transition: background 0.3s ease;
  }
  
  @keyframes slideInFromRight {
    0% {
      opacity: 0;
      transform: translateX(50px);
    }
    100% {
      opacity: 1;
      transform: translateX(0);
    }
  }

  /* Animation delays for top buttons */
  .admin-link-leh:nth-child(2) { animation-delay: 0.5s; }
  .admin-link-leh:nth-child(3) { animation-delay: 1s; }
</style>
</head>
<body>
<header>
  <h1>–ö–∞—Ä—Ç–∞ –õ–∞–¥–∞–∫—Ö–∞ ‚Äî –í–∞—à–∏ –º–µ—Å—Ç–∞</h1><br>
    <a href="https://t.me/leh_ladak" class="admin-link-leh" target="_blank" rel="noopener noreferrer">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.963 7.57l-1.79 8.427c-.135.582-.485.726-1.008.452l-2.792-2.063-1.346 1.296c-.148.147-.271.271-.555.271l.2-2.869 5.217-4.71c.226-.2-.05-.312-.35-.112l-6.453 4.063-2.773-.865c-.602-.185-.613-.602.127-.89l10.843-4.18c.503-.185.944.112.783.883z"/></svg>
      –ù–∞—à Telegram-–∫–∞–Ω–∞–ª
    </a>
    <a href="../index.html" class="admin-link-leh" rel="noopener noreferrer">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.963 7.57l-1.79 8.427c-.135.582-.485.726-1.008.452l-2.792-2.063-1.346 1.296c-.148.147-.271.271-.555.271l.2-2.869 5.217-4.71c.226-.2-.05-.312-.35-.112l-6.453 4.063-2.773-.865c-.602-.185-.613-.602.127-.89l10.843-4.18c.503-.185.944.112.783.883z"/></svg>
      –ù–∞ –≥–ª–∞–≤–Ω—É—é
    </a>
</header>
<main>
  <div class="upload-section">
    <h3>–ó–∞–≥—Ä—É–∑–∏—Ç–µ CSV —Ñ–∞–π–ª —Å –º–µ—Å—Ç–∞–º–∏</h3>
    <input type="file" id="file-input" accept=".csv" />
    <p>–§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–ª–æ–Ω–∫–∏: name, latitude, longitude, description</p>
  </div>

  <div class="stats" id="stats">
    –í—Å–µ–≥–æ –º–µ—Å—Ç –Ω–∞ –∫–∞—Ä—Ç–µ: <span id="points-count">0</span>
  </div>

  <div class="action-buttons">
    <button class="save-btn" id="save-all-btn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –º–µ—Å—Ç–∞</button>
    <button class="orange" id="save-new-btn">üÜï –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –º–µ—Å—Ç–∞</button>
    <button class="clear-btn" id="clear-custom-btn">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –º–µ—Å—Ç–∞</button>
    <button class="delete-all-btn" id="delete-all-btn">üí• –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –º–µ—Å—Ç–∞</button>
    <button class="food-btn" id="show-food-btn">üç¥ –ï–¥–∞–ª—å–Ω–∏ –≤ –õ–µ –æ—Ç –¢–∞—à—Ç–∞—à–Ω–∞–¢–∞—à</button>
  </div>

  <div id="map">
    <div class="map-controls">
      <button id="reset-view">üìç –í–µ—Ä–Ω—É—Ç—å –∫ –õ–∞–¥–∞–∫—Ö—É</button>
      <button class="save-btn" id="quick-save-btn">üíæ –í—Å–µ –º–µ—Å—Ç–∞</button>
      <button class="orange" id="quick-save-new-btn">üÜï –ù–æ–≤—ã–µ –º–µ—Å—Ç–∞</button>
      <button class="delete-all-btn" id="quick-delete-all-btn">üí• –í—Å–µ –º–µ—Å—Ç–∞</button>
      <button class="food-btn" id="quick-food-btn">üç¥ –ï–¥–∞–ª—å–Ω–∏</button>
    </div>
  </div>

  <div class="info">
    <h3>üìã –°–ø–∏—Å–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç:</h3>
    <ul id="places-list" style="list-style: none; padding-left: 0; max-height: 300px; overflow-y: auto;"></ul>
  </div>
</main>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://unpkg.com/papaparse@5.3.2/papaparse.min.js"></script>
<script>
  const map = L.map('map').setView([34.1526, 77.5771], 8);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  let allMarkers = [];
  let lastSaveTime = new Date();
  
  const samplePlaces = [
    { name: "–õ–µ—Ö", lat: 34.1526, lng: 77.5771, description: "–°—Ç–æ–ª–∏—Ü–∞ –õ–∞–¥–∞–∫—Ö–∞" },
    { name: "–ú–æ–Ω–∞—Å—Ç—ã—Ä—å –¢–∏–∫—Å–∏", lat: 34.0675, lng: 77.6653, description: "–ö—Ä—É–ø–Ω–µ–π—à–∏–π –º–æ–Ω–∞—Å—Ç—ã—Ä—å –≤ –õ–∞–¥–∞–∫—Ö–µ" },
    { name: "–û–∑–µ—Ä–æ –ü–∞–Ω–≥–æ–Ω–≥", lat: 33.7234, lng: 78.7711, description: "–í—ã—Å–æ–∫–æ–≥–æ—Ä–Ω–æ–µ —Å–æ–ª–µ–Ω–æ–µ –æ–∑–µ—Ä–æ" },
    { name: "–ü–µ—Ä–µ–≤–∞–ª –ö—Ö–∞—Ä–¥—É–Ω–≥-–õ–∞", lat: 34.2819, lng: 77.6183, description: "–û–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –≤—ã—Å–æ–∫–∏—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–≤–∞–ª–æ–≤ –≤ –º–∏—Ä–µ" },
    { name: "–î–≤–æ—Ä–µ—Ü –õ–µ—Ö", lat: 34.1667, lng: 77.5833, description: "–ë—ã–≤—à–∏–π –∫–æ—Ä–æ–ª–µ–≤—Å–∫–∏–π –¥–≤–æ—Ä–µ—Ü" },
    { name: "–ú–æ–Ω–∞—Å—Ç—ã—Ä—å –•–µ–º–∏—Å", lat: 33.9117, lng: 77.7142, description: "–ö—Ä—É–ø–Ω—ã–π –º–æ–Ω–∞—Å—Ç—ã—Ä—å —à–∫–æ–ª—ã –î—Ä–∏–∫—É–Ω–≥ –ö–∞–≥—å—é" },
    { name: "–î–æ–ª–∏–Ω–∞ –ù—É–±—Ä–∞", lat: 34.6167, lng: 77.4667, description: "–í—ã—Å–æ–∫–æ–≥–æ—Ä–Ω–∞—è –ø—É—Å—Ç—ã–Ω—è —Å –ø–µ—Å—á–∞–Ω—ã–º–∏ –¥—é–Ω–∞–º–∏" }
  ];

  // –î–∞–Ω–Ω—ã–µ –µ–¥–∞–ª–µ–Ω –æ—Ç –¢–∞—à—Ç–∞—à–Ω–∞–¢–∞—à
  const foodPlaces = [
    { name: "Achos Pizza", lat: 34.1664232, lng: 77.5850742, description: "–õ—É—á—à–∞—è –ø–∏—Ü—Ü–∞ –≤ –≥–æ—Ä–æ–¥–µ. –í–Ω—É—Ç—Ä–∏ –¥–æ–≤–æ–ª—å–Ω–æ —É—â–µ—Ä–±–Ω–∞—è –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∞, –Ω–æ –µ—Å–ª–∏ –Ω–µ –Ω–∞–ø—Ä—è–≥–∞–µ—Ç, —Ç–æ –æ–Ω–æ —Ç–æ–≥–æ —Å—Ç–æ–∏—Ç", type: "food" },
    { name: "Analog Bistro", lat: 34.1645678, lng: 77.5861234, description: "–õ—É—á—à–∏–π –∫–æ—Ñ–µ –≤ –≥–æ—Ä–æ–¥–µ. –í–∫—É—Å–Ω–∞—è –µ–¥–∞, —Ö–æ—Ä–æ—à–∏–µ –º—è—Å–Ω—ã–µ –±–ª—é–¥–∞, –¥–∞–∂–µ –±—É—Ä–≥–µ—Ä—ã –ø—Ä–∏–ª–∏—á–Ω—ã–µ. –ê –µ—â–µ –∫–ª–∞—Å—Å–Ω–∞—è –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –≤–∏–Ω–∏–ª–æ–≤—ã–π –ø—Ä–æ–∏–≥—Ä—ã–≤–∞—Ç–µ–ª—å", type: "food" },
    { name: "Amigo", lat: 34.1654321, lng: 77.5845678, description: "–î–æ–±—Ä–æ—Ç–Ω–∞—è –∫–æ—Ä–µ–π—Å–∫–∞—è –µ–¥–∞, –≤–∫—É—Å–Ω–æ–µ", type: "food" },
    { name: "Bon Appetit", lat: 34.1637890, lng: 77.5876543, description: "–•–æ—Ä–æ—à–∞—è –µ–≤—Ä–æ–ø–µ–π—Å–∫–∞—è –∫—É—Ö–Ω—è —Å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –ø–æ–¥–∞—á–µ–π, –º–µ—Å—Ç–æ –ø—Ä–∏—è—Ç–Ω–æ–µ, —á—Ç–æ–±—ã –ø–æ—Å–∏–¥–µ—Ç—å —Å –¥—Ä—É–∑—å—è–º–∏", type: "food" },
    { name: "SOL 101", lat: 34.1678901, lng: 77.5834567, description: "–ö–µ–±–∞–±—ã –∏ –≤–∫—É—Å–Ω—ã–π –º–∞–Ω–≥–æ —à–µ–π–∫", type: "food" },
    { name: "Montagne", lat: 34.1667890, lng: 77.5856789, description: "–ï—Å–ª–∏ —Å –±–µ–ª—ã–º–∏ —Å–∫–∞—Ç–µ—Ä—Ç—è–º–∏ —Ö–æ—á–µ—Ç—Å—è –ø–æ—Å–∏–¥–µ—Ç—å, –≤–∫—É—Å–Ω–æ –∏ –Ω–µ –¥–µ—à–µ–≤–æ (–Ω–æ –≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å –ï–≤—Ä–æ–ø–æ–π –≤—Å–µ —Ä–∞–≤–Ω–æ –∫–æ–ø–µ–π–∫–∏)", type: "food" },
    { name: "Tsas by Dolkhar", lat: 34.1656789, lng: 77.5867890, description: "–õ–∞–∫—à–µ—Ä–∏ –∑–∞ –≤—Å–µ –¥–µ–Ω—å–≥–∏. –õ–∞–¥–∞—Ö—Å–∫–∞—è –∫—É—Ö–Ω—è –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ª–∞–¥. –û—á–µ–Ω—å –∫—Ä–∞—Å–∏–≤–æ, –∏–≥—Ä–∞–µ—Ç –¥–∂–∞–∑, –æ—Ñ–∏—Ü–∏–∞–Ω—Ç—ã –ø—Ä–∏—á–µ—Å–∞–Ω–Ω—ã–µ. –ï–¥–∞ –≤–µ–≥–µ—Ç–µ—Ä–∏–∞–Ω—Å–∫–∞—è. –ï—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è –æ—Å–æ–±–µ–Ω–Ω—ã–º–∏", type: "food" },
    { name: "Tsering Patisserie", lat: 34.1643210, lng: 77.5854321, description: "–°—é–¥–∞ –∑–∞ —á–∏–∑–∫–µ–π–∫–∞–º–∏, —Ç–æ—Ä—Ç–∏–∫–∞–º–∏ –∏ —Ç–∏—Ä–∞–º–∏—Å—É —Å –∫–æ—Ñ–µ. –ï—Å—Ç—å –µ—â–µ –≤—Å—è–∫–∏–µ –±—É—Ç–µ—Ä—ã –∏ –≤—ã–ø–µ—á–∫–∞ —Å –º—è—Å–æ–º, –Ω–æ —è –Ω–µ –ø—Ä–æ–±–æ–≤–∞–ª–∞", type: "food" },
    { name: "Sugar House", lat: 34.1634567, lng: 77.5843210, description: "–û—Ç–ª–∏—á–Ω—ã–π –∫–æ—Ñ–µ –∏ –ª—É—á—à–∞—è –≤—ã–ø–µ—á–∫–∞ –≤ –≥–æ—Ä–æ–¥–µ - basque cake, carrot cake, blueberry cheesecake –ø—Ä–æ—Å—Ç–æ –Ω–µ—Å—Ä–∞–≤–Ω–µ–Ω–Ω—ã. –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ –æ–±—ã—á–Ω–æ–π –∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–æ–π", type: "food" },
    { name: "My Cafe", lat: 34.1689012, lng: 77.5823456, description: "–•–æ—Ä–æ—à–∏–π –∫–æ—Ñ–µ —Å –±–∞–ª–∫–æ–Ω—á–∏–∫–æ–º, –≤—ã—Ö–æ–¥—è—â–∏–º –Ω–∞ –º—ç–π–Ω –±–∞–∑–∞—Ä", type: "food" },
    { name: "Wazwan Planet", lat: 34.1676543, lng: 77.5832109, description: "–ú–Ω–æ–≥–æ –≤–∫—É—Å–Ω–æ–≥–æ –º—è—Å–∞ –≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫ –æ—Å–Ω–æ–≤–Ω—ã–º –∏–Ω–¥–∏–π—Å–∫–∏–º –±–ª—é–¥–∞–º", type: "food" },
    { name: "Karim", lat: 34.1665432, lng: 77.5840987, description: "–ê–ø–º–∞—Ä–∫–µ—Ç –≤–µ—Ä—Å–∏—è –í–∞–∑–≤–∞–Ω –ø–ª–∞–Ω–µ—Ç. –†–µ–∫–æ–º–µ–Ω–¥—É—é —Ä–∏—à—Ç—É - –º—è—Å–Ω—ã–µ —à–∞—Ä–∏–∫–∏ –≤ —Ç–æ–º–∞—Ç–Ω–æ–º —Å–æ—É—Å–µ", type: "food" },
    { name: "Asian Corner", lat: 34.1650987, lng: 77.5858765, description: "–û—á–µ–Ω—å –≤–∫—É—Å–Ω—ã–µ mutton momo", type: "food" },
    { name: "Cafe Jeevan", lat: 34.1648765, lng: 77.5865432, description: "–ù–∞—Å—Ç–æ—è—â–∏–µ –∫—Ä—É–∞—Å—Å–∞–Ω—ã –∏ –¥—Ä—É–≥–∞—è –≤—ã–ø–µ—á–∫–∞, –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–ª–∏–∑–∫–∏ –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏–º", type: "food" }
  ];

  function updateStats() {
    const placesCount = allMarkers.length;
    const customCount = allMarkers.filter(m => m.isCustom).length;
    const foodCount = allMarkers.filter(m => m.type === 'food').length;
    document.getElementById('points-count').textContent = `${placesCount} (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö: ${customCount}, –µ–¥–∞–ª–µ–Ω: ${foodCount})`;
    
    const list = document.getElementById('places-list');
    list.innerHTML = '';
    
    allMarkers.forEach(marker => {
      const item = document.createElement('li');
      item.className = 'places-list-item';
      
      let typeBadge = '';
      if (marker.type === 'food') {
        typeBadge = '<span class="place-type type-food">üç¥ –ï–¥–∞–ª—å–Ω—è</span>';
      } else if (marker.isCustom) {
        typeBadge = '<span class="place-type type-custom">–ù–æ–≤–æ–µ</span>';
      } else {
        typeBadge = '<span class="place-type type-default">–°—Ç–∞–Ω–¥–∞—Ä—Ç</span>';
      }
      
      item.innerHTML = `<b>${marker.name}</b> ${typeBadge}<br>${marker.lat.toFixed(4)}, ${marker.lng.toFixed(4)}<br>${marker.description}`;
      item.onclick = () => {
        map.setView([marker.lat, marker.lng], 12);
        marker.marker.openPopup();
      };
      list.appendChild(item);
    });
  }

  function addMarker(place, isCustom=false, type=null){
    let icon;
    if (type === 'food') {
      icon = L.divIcon({ html: 'üç¥', iconSize: [30, 30], className: 'food-marker' });
    } else if (isCustom) {
      icon = L.divIcon({ html: 'üìç', iconSize: [30, 30], className: 'custom-marker' });
    } else {
      icon = L.divIcon({ html: 'üî¥', iconSize: [25, 25], className: 'default-marker' });
    }

    const marker = L.marker([place.lat, place.lng], {
      icon: icon
    }).addTo(map).bindPopup(`<b>${place.name}</b><br>${place.description||''}`);
    
    allMarkers.push({ 
      marker, 
      name: place.name, 
      lat: place.lat, 
      lng: place.lng, 
      description: place.description||'', 
      isCustom, 
      type: type,
      created: new Date() 
    });
    
    updateStats();
  }

  // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –µ–¥–∞–ª–µ–Ω
  function showFoodPlaces() {
    // –°–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –µ–¥–∞–ª—å–Ω–∏
    const existingFoodMarkers = allMarkers.filter(m => m.type === 'food');
    existingFoodMarkers.forEach(markerData => {
      map.removeLayer(markerData.marker);
    });
    
    // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω–µ-–µ–¥–∞–ª—å–Ω–∏
    allMarkers = allMarkers.filter(m => m.type !== 'food');
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –µ–¥–∞–ª—å–Ω–∏
    foodPlaces.forEach(place => {
      addMarker(place, false, 'food');
    });
    
    // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∫–∞—Ä—Ç—É –Ω–∞ –µ–¥–∞–ª—å–Ω—è—Ö
    if (foodPlaces.length > 0) {
      const group = new L.featureGroup(foodPlaces.map(p => L.marker([p.lat, p.lng])));
      map.fitBounds(group.getBounds(), { padding: [20, 20] });
    }
    
    alert(`üç¥ –î–æ–±–∞–≤–ª–µ–Ω–æ ${foodPlaces.length} –µ–¥–∞–ª–µ–Ω –æ—Ç –¢–∞—à—Ç–∞—à–Ω–∞–¢–∞—à!`);
  }

  // –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö –º–µ—Å—Ç
  function deleteAllPoints() {
    if (allMarkers.length === 0) {
      alert('–ù–µ—Ç –º–µ—Å—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è!');
      return;
    }

    if (confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –í–°–ï ${allMarkers.length} –º–µ—Å—Ç? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!`)) {
      // –£–¥–∞–ª—è–µ–º –≤—Å–µ –º–∞—Ä–∫–µ—Ä—ã —Å –∫–∞—Ä—Ç—ã
      allMarkers.forEach(markerData => {
        map.removeLayer(markerData.marker);
      });
      
      // –û—á–∏—â–∞–µ–º –º–∞—Å—Å–∏–≤ –º–∞—Ä–∫–µ—Ä–æ–≤
      allMarkers = [];
      
      updateStats();
      alert('üí• –í—Å–µ –º–µ—Å—Ç–∞ —É–¥–∞–ª–µ–Ω—ã!');
    }
  }

  function saveAllPoints(){
    if(!allMarkers.length) { alert('–ù–µ—Ç –º–µ—Å—Ç –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!'); return; }
    
    let filename = prompt("–í–≤–µ–¥–∏—Ç–µ –∏–º—è —Ñ–∞–π–ª–∞ (–±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è):", "ladakh_all_places");
    if (!filename) return;
    
    let csv = "name,latitude,longitude,description,type\n";
    allMarkers.forEach(m=>{
      const escapedName = `"${m.name.replace(/"/g, '""')}"`;
      const escapedDescription = `"${(m.description || '').replace(/"/g, '""')}"`;
      const type = m.type === 'food' ? 'food' : (m.isCustom ? 'custom' : 'default');
      csv += `${escapedName},${m.lat},${m.lng},${escapedDescription},${type}\n`;
    });
    
    const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'}); 
    const a = document.createElement('a'); 
    a.href = URL.createObjectURL(blob); 
    a.download = `${filename}.csv`; 
    a.click();
    
    lastSaveTime = new Date();
    alert(`‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ ${allMarkers.length} –º–µ—Å—Ç –≤ —Ñ–∞–π–ª ${filename}.csv`);
  }

  function saveNewPoints() {
    const newMarkers = allMarkers.filter(marker => marker.isCustom && marker.created > lastSaveTime);
    if (newMarkers.length === 0) { alert('–ù–µ—Ç –Ω–æ–≤—ã—Ö –º–µ—Å—Ç –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!'); return; }

    let filename = prompt("–í–≤–µ–¥–∏—Ç–µ –∏–º—è —Ñ–∞–π–ª–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –º–µ—Å—Ç (–±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è):", "ladakh_new_places");
    if (!filename) return;

    let csvContent = "name,latitude,longitude,description\n";
    newMarkers.forEach(marker => {
      const escapedName = `"${marker.name.replace(/"/g, '""')}"`;
      const escapedDescription = `"${(marker.description || '').replace(/"/g, '""')}"`;
      csvContent += `${escapedName},${marker.lat},${marker.lng},${escapedDescription}\n`;
    });

    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    link.setAttribute('href', URL.createObjectURL(blob));
    link.setAttribute('download', filename + '.csv');
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);

    lastSaveTime = new Date();
    alert(`‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ ${newMarkers.length} –Ω–æ–≤—ã—Ö –º–µ—Å—Ç –≤ —Ñ–∞–π–ª ${filename}.csv`);
  }

  function clearCustomPoints() {
    const customMarkers = allMarkers.filter(marker => marker.isCustom);
    if (customMarkers.length === 0) { alert('–ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –º–µ—Å—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è!'); return; }

    if (confirm(`–£–¥–∞–ª–∏—Ç—å ${customMarkers.length} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –º–µ—Å—Ç?`)) {
      customMarkers.forEach(markerData => map.removeLayer(markerData.marker));
      allMarkers = allMarkers.filter(marker => !marker.isCustom);
      updateStats();
      alert('üóëÔ∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –º–µ—Å—Ç–∞ —É–¥–∞–ª–µ–Ω—ã!');
    }
  }

  document.getElementById('file-input').addEventListener('change', e=>{
    const file = e.target.files[0];
    if(!file) return;
    
    Papa.parse(file, {
      header: true,
      skipEmptyLines: true,
      complete: function(results){
        let bounds = [];
        let loadedCount = 0;
        
        results.data.forEach(place=>{
          const name = place.name || place.place || place.location;
          const lat = parseFloat(place.latitude || place.lat);
          const lon = parseFloat(place.longitude || place.lng || place.lon);
          const description = place.description || "";
          
          if(!isNaN(lat) && !isNaN(lon)) {
            addMarker({name, lat, lng: lon, description}, true);
            bounds.push([lat, lon]);
            loadedCount++;
          }
        });
        
        if (bounds.length > 0) map.fitBounds(bounds, { padding: [20, 20] });
        alert(`‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ ${loadedCount} –º–µ—Å—Ç`);
      },
      error: function(error) { alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞: ' + error); }
    });
  });

  // Click map to add new place
  map.on('click', function(e) {
    const lat = e.latlng.lat;
    const lon = e.latlng.lng;

    const name = prompt("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞:");
    if (!name) return;

    const description = prompt("–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):") || "";

    addMarker({ name, lat, lng: lon, description }, true);
  });

  // Map control buttons
  document.getElementById('reset-view').addEventListener('click', function() {
    map.setView([34.1526, 77.5771], 8);
  });
  document.getElementById('save-all-btn').addEventListener('click', saveAllPoints);
  document.getElementById('save-new-btn').addEventListener('click', saveNewPoints);
  document.getElementById('quick-save-btn').addEventListener('click', saveAllPoints);
  document.getElementById('quick-save-new-btn').addEventListener('click', saveNewPoints);
  document.getElementById('clear-custom-btn').addEventListener('click', clearCustomPoints);
  
  // New buttons
  document.getElementById('delete-all-btn').addEventListener('click', deleteAllPoints);
  document.getElementById('quick-delete-all-btn').addEventListener('click', deleteAllPoints);
  document.getElementById('show-food-btn').addEventListener('click', showFoodPlaces);
  document.getElementById('quick-food-btn').addEventListener('click', showFoodPlaces);

  // Prevent map click when clicking buttons
  document.querySelectorAll('.map-controls button').forEach(btn => {
    btn.addEventListener('click', function(event){
      event.stopPropagation();
    });
  });

  // Add predefined places
  samplePlaces.forEach(p => addMarker(p, false));
</script>
</body>
</html>
